
[[xls-source]]
=== XLS Source
The `xls` reads an _XLS_ spreadsheet file and creates an _OpenNMS requisition_ based on the worksheet content.

[options="header",cols="1,^1,10"]
|========================
| Parameter         | Required | Description
| `source`          | *        | set `xls` to use the XLS source for this requisition
| `source.file`     | *        | path of the XLS file to read relative to the `requisition.properties`
| `source.encoding` |          | encoding of the xls file. Default is ISO-8859-1
|========================

The structure of the spreadsheet has to follow these rules.
The source reads from a sheet named after the requisition you are requesting.
The first row of each sheet is reserved for `column names`.
These `column names` have to start with certain prefixes to be recognized.

[options="header",cols="1,^1,10"]
|========================
| Prefixes          | Required | Description
| `Node_`           | *        | will be interpreted as node label and `foreignId`.
| `IP_`             | *        | will be interpreted as an IP address as a new interface on the node.
| `MgmtType_`       | *        | is interpreted as `snmp-primary` flag and controls how the interface can be used to communicate with the SNMP agent. Valid are `P` (Primary), `S` (Secondary) and `N` (None).
| `InterfaceStatus` |          | will be interpreted as interface status. This is NOT a prefix. The column name has to match exactly. Use `1` for monitored and `3` for not monitored.
| `cat_`            |          | will be interpreted as a surveillance category. Multiple comma-separated categories can be provided. It can be used multiple times per sheet.
| `svc_`            |          | will be interpreted as a service on the interface of the node. Multiple comma-separated services can be provided. It can be used multiple times per sheet.
|========================

This source also supports all asset-fields by using `Asset_` as a prefix followed by the `asset-field-name`.
The city field of the assets can be addressed like this: `Asset_City`.
This is not case-sensitive.

To add a node with multiple interfaces, add a subsequent row with the same node label (Node_).
This row will be added as a new interface based on the data from the  IP_, MgmtType_, svc_ columns.

The order in which the columns are arranged is irrelevant. Also additional columns can be present.

.Example configuration for the requisition myRouter from an XLS spreadsheet
[source,bash]
----
include::{docdir}/configs/examples/xlsExample/requisitions/myRouter/requisition.properties[]
----
